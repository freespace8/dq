Copy from https://github.com/jiaxwu/dq